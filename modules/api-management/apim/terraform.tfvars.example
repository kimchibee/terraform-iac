#--------------------------------------------------------------
# API Management Module - terraform.tfvars 예시
# 환경별로 이 파일을 복사하여 실제 값으로 수정
#--------------------------------------------------------------

# API Management 기본 설정
apim_name            = "apim-spoke"
apim_sku_name        = "Developer_1"
apim_publisher_name  = "My Organization"
apim_publisher_email = "admin@example.com"

# API 목록 (잦은 변경 예상)
apis = {
  "user-api" = {
    display_name = "User API"
    path         = "users"
    protocols    = ["https"]
    service_url  = "https://user-service.internal"
    policy_file  = "config/user-api-policy.xml"  # 선택사항
  }
  "order-api" = {
    display_name = "Order API"
    path         = "orders"
    protocols    = ["https"]
    service_url  = "https://order-service.internal"
    policy_file  = "config/order-api-policy.xml"  # 선택사항
  }
  # 환경별로 추가/삭제 가능
  # "product-api" = {
  #   display_name = "Product API"
  #   path         = "products"
  #   protocols    = ["https"]
  #   service_url  = "https://product-service.internal"
  # }
}

# 정책 파일 경로
policies = {
  global_policy = "config/apim-policy.xml"  # 전역 정책
  api_policies = {
    # API별 정책 (apis에서 policy_file 지정 시 자동 적용)
  }
}

# Backend 서비스 설정 (선택사항)
backends = {
  "user-backend" = {
    url              = "https://user-service.internal"
    protocol         = "https"
    authentication  = "managed_identity"
    managed_identity_id = "/subscriptions/.../resourceGroups/.../providers/Microsoft.ManagedIdentity/userAssignedIdentities/user-identity"
  }
}

# 기존 리소스 재사용 (선택사항)
# existing_subnet_id = "/subscriptions/.../resourceGroups/.../providers/Microsoft.Network/virtualNetworks/.../subnets/apim-snet"
# key_vault_name     = "existing-key-vault"
